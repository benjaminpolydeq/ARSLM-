# üöÄ Guide d'Installation Complet ARSLM

## üìã Vue d'Ensemble

Ce guide vous accompagne pas √† pas pour migrer et installer le nouveau d√©p√¥t ARSLM structur√©.

---

## ‚ö†Ô∏è Avant de Commencer

### Pr√©requis

- Git install√©
- Python 3.8+ install√©
- Docker et Docker Compose (optionnel)
- 8GB RAM minimum
- 5GB d'espace disque

### Sauvegarde

**IMPORTANT**: Cr√©ez une sauvegarde avant de commencer !

```bash
cd votre-repo-arslm
git checkout -b backup-$(date +%Y%m%d)
git push origin backup-$(date +%Y%m%d)
```

---

## üéØ Option 1: Migration Automatique (Recommand√©)

### √âtape 1: T√©l√©charger le Script de Migration

```bash
# Dans votre d√©p√¥t ARSLM
cd ARSLM

# T√©l√©charger le script
curl -O https://raw.githubusercontent.com/benjaminpolydeq/ARSLM/main/scripts/migrate_repository.py

# Rendre ex√©cutable
chmod +x migrate_repository.py
```

### √âtape 2: Ex√©cuter la Migration

```bash
python migrate_repository.py
```

Le script va :
- ‚úÖ Cr√©er une branche de backup
- ‚úÖ Cr√©er la nouvelle structure
- ‚úÖ Migrer les fichiers existants
- ‚úÖ Cr√©er les fichiers de configuration
- ‚úÖ Nettoyer les anciens fichiers

### √âtape 3: V√©rifier la Migration

```bash
# V√©rifier la structure
tree -L 3 -I '__pycache__|*.pyc'

# Devrait afficher:
# .
# ‚îú‚îÄ‚îÄ src/
# ‚îÇ   ‚îú‚îÄ‚îÄ arslm/
# ‚îÇ   ‚îú‚îÄ‚îÄ api/
# ‚îÇ   ‚îî‚îÄ‚îÄ frontend/
# ‚îú‚îÄ‚îÄ tests/
# ‚îú‚îÄ‚îÄ docs/
# ‚îú‚îÄ‚îÄ config/
# ‚îî‚îÄ‚îÄ ...
```

---

## üõ†Ô∏è Option 2: Migration Manuelle

### √âtape 1: Cr√©er la Structure

```bash
# Cr√©er tous les dossiers
mkdir -p src/{arslm/{core,training,inference,utils},api/{routes,schemas,middleware},frontend/{pages,components}}
mkdir -p tests/{unit,integration,fixtures}
mkdir -p docs config scripts data/sample models/checkpoints notebooks docker
mkdir -p .github/workflows .github/ISSUE_TEMPLATE
```

### √âtape 2: Cr√©er les Fichiers __init__.py

```bash
# Pour tous les packages Python
find src tests -type d -exec touch {}/__init__.py \;
```

### √âtape 3: Migrer les Fichiers Existants

```bash
# Sauvegarder et d√©placer
cp ARSLM.py src/arslm/core/model.py
cp streamlit_app.py src/frontend/app.py
cp main.py src/api/main.py

# Si vous avez d'autres fichiers, adaptez selon besoin
```

### √âtape 4: Cr√©er les Fichiers de Configuration

#### `.gitignore`

```bash
cat > .gitignore << 'EOF'
# Python
__pycache__/
*.py[cod]
.Python
build/
dist/
*.egg-info/
venv/

# IDEs
.vscode/
.idea/

# Environment
.env

# Logs
*.log
logs/

# Models & Data
models/*.pt
data/processed/
EOF
```

#### `.env.example`

```bash
cat > .env.example << 'EOF'
# Application
APP_NAME=ARSLM
ENVIRONMENT=development

# API
API_HOST=0.0.0.0
API_PORT=8000

# Model
MODEL_PATH=./models/arslm_base.pt
EOF
```

---

## üì¶ Installation des D√©pendances

### M√©thode 1: Avec pip

```bash
# Cr√©er environnement virtuel
python -m venv venv
source venv/bin/activate  # Windows: venv\Scripts\activate

# Installer le package en mode d√©veloppement
pip install -e ".[dev]"

# Ou installer depuis requirements
pip install -r requirements.txt
pip install -r requirements-dev.txt
```

### M√©thode 2: Avec Poetry (Recommand√©)

```bash
# Installer Poetry
curl -sSL https://install.python-poetry.org | python3 -

# Installer d√©pendances
poetry install

# Activer environnement
poetry shell
```

---

## üê≥ Installation avec Docker

### √âtape 1: Build l'Image

```bash
# Build l'image Docker
docker build -t arslm:latest -f docker/Dockerfile .
```

### √âtape 2: Lancer avec Docker Compose

```bash
# Copier le fichier d'environnement
cp .env.example .env

# √âditer les variables si n√©cessaire
nano .env

# D√©marrer tous les services
docker-compose -f docker/docker-compose.yml up -d

# V√©rifier le statut
docker-compose ps
```

### Services Disponibles

- **API**: http://localhost:8000
- **Frontend**: http://localhost:8501
- **PostgreSQL**: localhost:5432
- **Redis**: localhost:6379

---

## ‚úÖ V√©rification de l'Installation

### 1. Tester l'API

```bash
# Health check
curl http://localhost:8000/health

# Devrait retourner:
# {"status":"healthy","version":"1.0.0","model_loaded":true}
```

### 2. Tester le Frontend

```bash
# Lancer Streamlit
streamlit run src/frontend/app.py

# Ouvrir: http://localhost:8501
```

### 3. Ex√©cuter les Tests

```bash
# Tous les tests
pytest

# Avec coverage
pytest --cov=src --cov-report=html

# Tests sp√©cifiques
pytest tests/unit/test_model.py -v
```

---

## üîß Configuration Post-Installation

### 1. Configuration de l'Environnement

√âditez `.env`:

```bash
# Pour d√©veloppement
ENVIRONMENT=development
DEBUG=true
LOG_LEVEL=DEBUG

# Pour production
ENVIRONMENT=production
DEBUG=false
LOG_LEVEL=WARNING
```

### 2. T√©l√©charger un Mod√®le Pr√©-entra√Æn√© (Optionnel)

```bash
# Cr√©er le dossier models si n√©cessaire
mkdir -p models

# T√©l√©charger un checkpoint (exemple)
# wget https://example.com/arslm_base.pt -O models/arslm_base.pt
```

### 3. Initialiser la Base de Donn√©es (Si utilis√©e)

```bash
# Avec Alembic (migrations)
alembic upgrade head

# Ou cr√©er manuellement
python scripts/init_database.py
```

---

## üîÑ Migration des Imports

Apr√®s la restructuration, vous devez mettre √† jour les imports dans vos fichiers Python.

### Anciens Imports
```python
from ARSLM import ARSLMModel
import microllm_core
```

### Nouveaux Imports
```python
from src.arslm.core.model import ARSLMModel
from src.arslm.utils.tokenizer import SimpleTokenizer
```

### Script de Migration des Imports

```bash
# Trouver tous les imports √† corriger
grep -r "from ARSLM import" src/
grep -r "import ARSLM" src/

# Remplacer automatiquement (Linux/Mac)
find src/ -type f -name "*.py" -exec sed -i 's/from ARSLM import/from src.arslm.core.model import/g' {} +
```

---

## üöÄ Premier Lancement

### D√©marrage Complet

```bash
# Terminal 1: API
uvicorn src.api.main:app --reload --host 0.0.0.0 --port 8000

# Terminal 2: Frontend
streamlit run src/frontend/app.py --server.port 8501

# Ou utiliser Docker Compose
docker-compose up
```

### Test Rapide

```python
# test_quick.py
from src.arslm.core.model import ARSLMModel, ARSLMConfig
from src.arslm.utils.tokenizer import SimpleTokenizer

# Cr√©er mod√®le
config = ARSLMConfig(vocab_size=10000, d_model=256, n_layers=2)
model = ARSLMModel(config)

# Cr√©er tokenizer
tokenizer = SimpleTokenizer(vocab_size=10000)

# Test simple
text = "Hello world"
token_ids = tokenizer.encode(text)
print(f"Token IDs: {token_ids}")

decoded = tokenizer.decode(token_ids)
print(f"Decoded: {decoded}")

print("‚úÖ Installation valid√©e!")
```

```bash
python test_quick.py
```

---

## üêõ D√©pannage

### Probl√®me 1: Module Not Found

```bash
# Erreur: ModuleNotFoundError: No module named 'src'

# Solution 1: Installer en mode √©ditable
pip install -e .

# Solution 2: Ajouter au PYTHONPATH
export PYTHONPATH="${PYTHONPATH}:$(pwd)"

# Solution 3: Utiliser imports relatifs
python -m src.api.main
```

### Probl√®me 2: Port D√©j√† Utilis√©

```bash
# Erreur: Address already in use

# Trouver le processus
lsof -i :8000  # Pour l'API
lsof -i :8501  # Pour Streamlit

# Tuer le processus
kill -9 <PID>

# Ou changer le port
uvicorn src.api.main:app --port 8001
```

### Probl√®me 3: D√©pendances Manquantes

```bash
# R√©installer toutes les d√©pendances
pip install --upgrade -r requirements.txt

# Ou recr√©er l'environnement
rm -rf venv
python -m venv venv
source venv/bin/activate
pip install -e ".[dev]"
```

### Probl√®me 4: Docker Build √âchoue

```bash
# Nettoyer le cache Docker
docker builder prune -a

# Rebuild sans cache
docker-compose build --no-cache

# V√©rifier les logs
docker-compose logs -f api
```

---

## üìä V√©rification Finale

### Checklist

- [ ] Structure de dossiers cr√©√©e
- [ ] Fichiers migr√©s avec succ√®s
- [ ] Environnement virtuel activ√©
- [ ] D√©pendances install√©es
- [ ] Tests passent (pytest)
- [ ] API d√©marre sans erreur
- [ ] Frontend accessible
- [ ] Docker Compose fonctionne
- [ ] Imports mis √† jour
- [ ] Documentation accessible

### Script de Validation

```bash
#!/bin/bash
# validate_installation.sh

echo "üîç Validation de l'installation..."

# V√©rifier Python
python --version || exit 1

# V√©rifier les d√©pendances
pip list | grep "torch\|fastapi\|streamlit" || exit 1

# V√©rifier la structure
[ -d "src/arslm" ] || exit 1
[ -d "src/api" ] || exit 1
[ -d "tests" ] || exit 1

# Lancer les tests
pytest tests/ --maxfail=1 || exit 1

echo "‚úÖ Installation valid√©e avec succ√®s!"
```

```bash
chmod +x validate_installation.sh
./validate_installation.sh
```

---

## üéâ Prochaines √âtapes

1. **Lire la documentation**
   ```bash
   # Architecture
   cat docs/ARCHITECTURE.md
   
   # API Reference
   open http://localhost:8000/docs
   ```

2. **Explorer le code**
   ```bash
   # Mod√®le principal
   cat src/arslm/core/model.py
   
   # API
   cat src/api/main.py
   ```

3. **Commencer √† d√©velopper**
   ```bash
   # Cr√©er une branche
   git checkout -b feature/my-feature
   
   # Faire vos modifications
   # ...
   
   # Tester
   pytest
   
   # Commit
   git add .
   git commit -m "feat: add my feature"
   ```

---

## üìû Support

### Probl√®me persistant ?

1. **V√©rifier les Issues GitHub**
   https://github.com/benjaminpolydeq/ARSLM/issues

2. **Cr√©er une nouvelle Issue**
   - D√©crire le probl√®me
   - Inclure les logs d'erreur
   - Sp√©cifier votre environnement

3. **Contact direct**
   - Email: benjokama@hotmail.fr
   - GitHub: @benjaminpolydeq

---

## üìö Ressources Additionnelles

- [Architecture Documentation](docs/ARCHITECTURE.md)
- [API Reference](http://localhost:8000/docs)
- [Contributing Guide](CONTRIBUTING.md)
- [Changelog](CHANGELOG.md)

---

**‚úÖ Installation termin√©e ! Bon d√©veloppement ! üöÄ**
